[{id32045af3.2d2606,typedebug,z1ccdb44a.47d52c,name,activetrue,consoletrue,completetrue,x2735.28324508667,y428.61664485931396,wires[]},{id417602ff.385dbc,typedebug,z1ccdb44a.47d52c,name,activetrue,consoletrue,completetrue,x2737.78324508667,y536.1166458129883,wires[]},{id7ba7e4d9.e4f30c,typeinject,z1ccdb44a.47d52c,namestart calling,topic,payload,payloadTypedate,repeat,crontab,oncefalse,x147.9285659790039,y455.71426582336426,wires[[cb117cb8.1cf2c,ecac340d.0e7118,66935b40.b14934,ca509d38.9e103]]},{idcb117cb8.1cf2c,typedebug,z1ccdb44a.47d52c,name,activefalse,consolefalse,completepayload,x413.3333511352539,y386.666672706604,wires[]},{id66935b40.b14934,typefunction,z1ccdb44a.47d52c,nameget_brightness command,funcvar address = (''+msg.unitAddress).match(^[^0-9a-f]([0-9a-f]+)[^0-9a-f]$)[1];ncontext.global.Xexsg = 30344719333832391b002000;nmsg.payload = {commandget_brightness,unitcontext.global.Xexsg,arguments{}};nreturn msg;,outputs1,noerr0,x419.99998474121094,y174.8571376800537,wires[[4afdbdc2.874f84,f8229bf3.661398]]},{id4afdbdc2.874f84,typedebug,z1ccdb44a.47d52c,nameget_brightness command,activefalse,consolefalse,completepayload,x463.00000762939453,y286.5000114440918,wires[]},{idf8229bf3.661398,typejson,z1ccdb44a.47d52c,nameencode json,x708.6071166992188,y177.28571128845215,wires[[58bef0d4.f02fb,aa661547.a632f8]]},{id58bef0d4.f02fb,typehttp request,z1ccdb44a.47d52c,namepush to shelfnet,methodPOST,retobj,urlhttp67.60.125.24360080sendget_brightness,tls,x918.6428833007812,y180.17855834960938,wires[[e42fd0ff.bdd44,12224147.199f8f]]},{ide42fd0ff.bdd44,typedebug,z1ccdb44a.47d52c,namebrightness msg object returned from ShelfNet,activefalse,consolefalse,completepayload,x1112.6667022705078,y295.0833168029785,wires[]},{idecac340d.0e7118,typefunction,z1ccdb44a.47d52c,nameget_temp_rh command,funcvar address = (''+msg.unitAddress).match(^[^0-9a-f]([0-9a-f]+)[^0-9a-f]$)[1];nmsg.payload = {commandget_temp_rh,unitcontext.global.Xexsg,arguments{}};nreturn msg;,outputs1,noerr0,x462.00000381469727,y456.50001525878906,wires[[9287e13d.aedf2,5d7aa732.fd6148]]},{idaa661547.a632f8,typedebug,z1ccdb44a.47d52c,name,activefalse,consolefalse,completefalse,x761.5000152587891,y288.5000114440918,wires[]},{id9287e13d.aedf2,typejson,z1ccdb44a.47d52c,nameencode json,x713.7500076293945,y456.50003814697266,wires[[6a842d6d.7baee4,7007527d.f8cd5c]]},{id6a842d6d.7baee4,typehttp request,z1ccdb44a.47d52c,namepush to shelfnet,methodPOST,retobj,urlhttp67.60.125.24360080sendget_temp_rh,tls,x938.7500152587891,y456.25000762939453,wires[[c76ea406.b2a1b8,686651bc.b10d3]]},{id54348bcd.488bf4,typehttp request,z1ccdb44a.47d52c,nameSend to HANA,methodPOST,rettxt,urlhttpsiotmmsp1942404413trial.hanatrial.ondemand.comcom.sap.iotservices.mmsv1apihttpdata956430da-e9ae-40c4-81ef-4715f3d88fb5,tls,x2423.5000381469727,y209.3333797454834,wires[[]]},{idfdca0d60.14b81,typedebug,z1ccdb44a.47d52c,nameFormatted HANA Message,activefalse,consoletrue,completepayload,x1911.5832824707031,y95.75000381469727,wires[]},{ida25f24ba.ced408,typefunction,z1ccdb44a.47d52c,namebuild HANA brightness push,funcvar brightness = msg.payload.birghtness.data.brightness;nvar temp = msg.payload.temp.data.temp;nvar year = msg.payload.time.data.year;nvar month = msg.payload.time.data.month;nvar day = msg.payload.time.data.day;nvar hours = msg.payload.time.data.hours;nvar minutes = msg.payload.time.data.minutes;nvar seconds = msg.payload.time.data.seconds;nnmsg.payload = {modesync, messageType21a2cbfb64a1add0f24d, messages[{idcontext.global.Xexsg,timestampyear+-+month+-+day+T+hours++minutes++seconds,luxbrightness100.0}]};nreturn msg;,outputs1,noerr0,x1740.857078552246,y429.76190853118896,wires[[7daa951c.16225c,65ee8f1.abe2d7]]},{idc76ea406.b2a1b8,typedebug,z1ccdb44a.47d52c,nametemp_rh msg object returned from ShelfNet,activetrue,consolefalse,completepayload,x1085,y565,wires[]},{idbe4de3f8.45502,typefunction,z1ccdb44a.47d52c,nameBuild HANA JSON Brightness Payload,funcSplit current payload into arraynvar unformattedMsg = JSON.parse(msg.payload);nvar msgArray = msg.payload.split( );nnmsg.payload = {modesync, messageType21a2cbfb64a1add0f24d, messages[{idSensorNameHere, timestamp2016-11-15T084537.930Z, lux msgArray[5]}]};nnreturn msg;,outputs1,noerr0,x1585.6836242675781,y194.30002212524414,wires[[fdca0d60.14b81,fd483ce.009f2c]]},{id65bc774f.6b0648,typedebug,z1ccdb44a.47d52c,nameInput going to temp check,activetrue,consolefalse,completepayload,x2048.783233642578,y610.4500217437744,wires[]},{idfd483ce.009f2c,typejson,z1ccdb44a.47d52c,nameencode json,x1907.5000305175781,y201.44998741149902,wires[[37dbd2c4.dcabfe]]},{id37dbd2c4.dcabfe,typefunction,z1ccdb44a.47d52c,nameAdd HANA JSON Header,funcmsg.headers = {n    Authorization Bearer 6da70c86c1dede37d259cff922aad5,n    Content-type  applicationjsonn};nnreturn msg;,outputs1,noerr0,x2173.416534423828,y212.13333702087402,wires[[54348bcd.488bf4]]},{idca509d38.9e103,typefunction,z1ccdb44a.47d52c,namegettime command,funcvar address = (''+msg.unitAddress).match(^[^0-9a-f]([0-9a-f]+)[^0-9a-f]$)[1];nmsg.payload = {commandgettime,unitcontext.global.Xexsg,arguments{}};nreturn msg;,outputs1,noerr0,x436.6666564941406,y690,wires[[d538c843.846c98,926294e5.5deb58]]},{idd538c843.846c98,typedebug,z1ccdb44a.47d52c,namegettime command,activefalse,consolefalse,completepayload,x479.6666793823242,y801.6428737640381,wires[]},{id926294e5.5deb58,typejson,z1ccdb44a.47d52c,nameencode json,x745.2737884521484,y692.4285736083984,wires[[bd46764.2ef6688,6166000.0c1f8]]},{idbd46764.2ef6688,typehttp request,z1ccdb44a.47d52c,namepush to shelfnet,methodPOST,retobj,urlhttp67.60.125.24360080sendgettime,tls,x960.3095855712891,y692.82142162323,wires[[f0d02d5.c531ed,fd0c6acc.21b7e8]]},{idf0d02d5.c531ed,typedebug,z1ccdb44a.47d52c,nametime msg object returned from ShelfNet,activefalse,consolefalse,completepayload,x1115.1666870117188,y799.3928737640381,wires[]},{id6166000.0c1f8,typedebug,z1ccdb44a.47d52c,name,activefalse,consolefalse,completefalse,x798.1666870117188,y803.6428737640381,wires[]},{id7007527d.f8cd5c,typedebug,z1ccdb44a.47d52c,nameencode json check1,activetrue,consolefalse,completepayload,x773.3333435058594,y563.3333358764648,wires[]},{id5d7aa732.fd6148,typedebug,z1ccdb44a.47d52c,nameget_temp_rh command,activetrue,consolefalse,completepayload,x491.6666564941406,y565,wires[]},{id7daa951c.16225c,typedebug,z1ccdb44a.47d52c,name,activetrue,consolefalse,completefalse,x2015.8332824707031,y355.83331775665283,wires[]},{idd9580cd8.cf15a,typedebug,z1ccdb44a.47d52c,namejoin check,activetrue,consolefalse,completepayload,x1653.3332748413086,y352.5000705718994,wires[]},{id874e643a.49d2c8,typejoin,z1ccdb44a.47d52c,name,modecustom,buildobject,propertypayload,propertyTypemsg,keytopic,joinern,timeout,count3,x1468.3332710266113,y469.99997329711914,wires[[a25f24ba.ced408,d9580cd8.cf15a,1a9b5a23.bef776]]},{id12224147.199f8f,typefunction,z1ccdb44a.47d52c,nameadding a topic,funcmsg.topic = birghtness;nreturn msg;,outputs1,noerr0,x1230.000129699707,y181.66667556762695,wires[[874e643a.49d2c8]]},{id686651bc.b10d3,typefunction,z1ccdb44a.47d52c,nameadding a topic,funcmsg.topic = temp;nreturn msg;,outputs1,noerr0,x1237.500015258789,y457.4999761581421,wires[[874e643a.49d2c8]]},{idfd0c6acc.21b7e8,typefunction,z1ccdb44a.47d52c,nameadding a topic,funcmsg.topic = time;nreturn msg;,outputs1,noerr0,x1246.6666412353516,y693.3333234786987,wires[[874e643a.49d2c8]]},{idb0a41947.5d76f8,typehttp request,z1ccdb44a.47d52c,nameSend to HANA,methodPOST,retobj,urlhttpsiotmmsp1942404413trial.hanatrial.ondemand.comcom.sap.iotservices.mmsv1apihttpdata956430da-e9ae-40c4-81ef-4715f3d88fb5,tls,x2532.5000381469727,y427.5000057220459,wires[[32045af3.2d2606]]},{id65ee8f1.abe2d7,typejson,z1ccdb44a.47d52c,nameencode json,x2013.9999923706055,y427.1166076660156,wires[[7d860ecd.d9b8f]]},{id7d860ecd.d9b8f,typefunction,z1ccdb44a.47d52c,nameAdd HANA JSON Header,funcmsg.headers = {n    Authorization Bearer 6da70c86c1dede37d259cff922aad5,n    Content-type  applicationjsonn};nnreturn msg;,outputs1,noerr0,x2275.4165267944336,y429.79998302459717,wires[[b0a41947.5d76f8]]},{id404026a5.fc55a8,typehttp request,z1ccdb44a.47d52c,nameSend to HANA,methodPOST,retobj,urlhttpsiotmmsp1942404413trial.hanatrial.ondemand.comcom.sap.iotservices.mmsv1apihttpdata956430da-e9ae-40c4-81ef-4715f3d88fb5,tls,x2532.5000381469727,y537.5000076293945,wires[[417602ff.385dbc]]},{idbeb8596e.a19b88,typejson,z1ccdb44a.47d52c,nameencode json,x2007.5000305175781,y536.1166687011719,wires[[e8d8a51e.5eb358]]},{ide8d8a51e.5eb358,typefunction,z1ccdb44a.47d52c,nameAdd HANA JSON Header,funcmsg.headers = {n    Authorization Bearer 6da70c86c1dede37d259cff922aad5,n    Content-type  applicationjsonn};nnreturn msg;,outputs1,noerr0,x2279.916534423828,y537.799934387207,wires[[404026a5.fc55a8]]},{id1a9b5a23.bef776,typefunction,z1ccdb44a.47d52c,namebuild HANA temp push,funcvar brightness = msg.payload.birghtness.data.brightness;nvar temp = msg.payload.temp.data.temp;nvar year = msg.payload.time.data.year;nvar month = msg.payload.time.data.month;nvar day = msg.payload.time.data.day;nvar hours = msg.payload.time.data.hours;nvar minutes = msg.payload.time.data.minutes;nvar seconds = msg.payload.time.data.seconds;nnmsg.payload = {modesync, messageTypebe77e1f13675f09bc87a, messages[{idcontext.global.Xexsg,timestampyear+-+month+-+day+T+hours++minutes++seconds,celsiustemp100.0}]};nreturn msg;,outputs1,noerr0,x1755.999984741211,y540.0000629425049,wires[[65bc774f.6b0648,beb8596e.a19b88,7d718de7.4a1644]]},{id7d718de7.4a1644,typefunction,z1ccdb44a.47d52c,nameCheck Temperature Range,funccheck temp rangenvar temp = msg.payload.messages.celcius;nif (temp  27  temp  10) n{n    set led to redn    msg.payload = {commandset_led,unitcontext.global.Xexsg,arguments{id  0, brightness  255, sequence  0, color 25}};n}nadd error flagnmsg.messages.flag = tempOutOfBounds;nreturn msg;,outputs1,noerr0,x2067.6666564941406,y809.0000553131104,wires[[944eae8d.08024]]},{id944eae8d.08024,typedebug,z1ccdb44a.47d52c,nametemp range function check,activetrue,consolefalse,completepayload,x2348.6665649414062,y808.0000495910645,wires[]},{id327b3a6b.2fdf56,typefunction,z1ccdb44a.47d52c,nameset_led green command,funcvar address = (''+msg.unitAddress).match(^[^0-9a-f]([0-9a-f]+)[^0-9a-f]$)[1];nmsg.payload = {commandset_led,unitcontext.global.Xexsg,arguments{id  0, brightness  255, sequence  0, color 224}};nreturn msg;,outputs1,noerr0,x424.7618408203125,y1281.9047985076904,wires[[1912b173.05efff,749ab31b.2f1fcc]]},{id1912b173.05efff,typedebug,z1ccdb44a.47d52c,namegettime command,activetrue,consolefalse,completepayload,x447.7618637084961,y1393.5476722717285,wires[]},{id749ab31b.2f1fcc,typejson,z1ccdb44a.47d52c,nameencode json,x713.3689727783203,y1284.3333721160889,wires[[4aacc5e3.a2e08c,699d35f3.b6482c]]},{id4aacc5e3.a2e08c,typehttp request,z1ccdb44a.47d52c,namepush to shelfnet,methodPOST,retobj,urlhttp67.60.125.24360080sendset_led,tls,x928.4047698974609,y1284.7262201309204,wires[[7704e3ba.71018c,14fb8573.21e3cb]]},{id7704e3ba.71018c,typedebug,z1ccdb44a.47d52c,nametime msg object returned from ShelfNet,activetrue,consolefalse,completepayload,x1083.2618713378906,y1391.2976722717285,wires[]},{id699d35f3.b6482c,typedebug,z1ccdb44a.47d52c,name,activetrue,consolefalse,completefalse,x766.2618713378906,y1395.5476722717285,wires[]},{ida3561aa7.f4cc28,typefunction,z1ccdb44a.47d52c,nameset_led off command,funcvar address = (''+msg.unitAddress).match(^[^0-9a-f]([0-9a-f]+)[^0-9a-f]$)[1];nmsg.payload = {commandset_led,unitcontext.global.Xexsg,arguments{id  0, brightness  0, sequence  0, color 96}};nreturn msg;,outputs1,noerr0,x1776.1904296875,y1289.5238003730774,wires[[e1370199.71c09,55ea5dd5.f9c554]]},{ide1370199.71c09,typedebug,z1ccdb44a.47d52c,namegettime command,activetrue,consolefalse,completepayload,x1809.1904525756836,y1401.1666741371155,wires[]},{id55ea5dd5.f9c554,typejson,z1ccdb44a.47d52c,nameencode json,x2074.797561645508,y1291.9523739814758,wires[[e42d1452.33e048,154bb52f.2cf82b]]},{id195c71de.a6487e,typedebug,z1ccdb44a.47d52c,nametime msg object returned from ShelfNet,activetrue,consolefalse,completepayload,x2444.690460205078,y1398.9166741371155,wires[]},{ide42d1452.33e048,typedebug,z1ccdb44a.47d52c,name,activetrue,consolefalse,completefalse,x2127.690460205078,y1403.1666741371155,wires[]},{idfd4922a7.932ad,typedelay,z1ccdb44a.47d52c,nameDelay Between green and off,pauseTypedelay,timeout5,timeoutUnitsseconds,rate1,rateUnitssecond,randomFirst1,randomLast5,randomUnitsseconds,dropfalse,x1474.2858123779297,y1289.5238952636719,wires[[a3561aa7.f4cc28]]},{ide120d7e6.e750c8,typeinject,z1ccdb44a.47d52c,name,topic,payload,payloadTypedate,repeat,crontab,oncetrue,x127,y1281,wires[[327b3a6b.2fdf56]]},{id154bb52f.2cf82b,typehttp request,z1ccdb44a.47d52c,namepush to shelfnet,methodPOST,retobj,urlhttp67.60.125.24360080sendset_led,tls,x2318.33309173584,y1293.3333067893982,wires[[195c71de.a6487e]]},{id14fb8573.21e3cb,typechange,z1ccdb44a.47d52c,nameDelete header clash,rules[{tdelete,pheaders,ptmsg}],action,property,from,to,regfalse,x1189.9999618530273,y1284.999967098236,wires[[fd4922a7.932ad]]}]